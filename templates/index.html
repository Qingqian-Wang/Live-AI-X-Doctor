{% extends "base.html" %}

{% block title %}Chat Interface{% endblock %}

{% block content %}
<div class="chat-interface">
    {% for message in messages %}
    {% if message.role == 'user' %}
    <div class="user-message-container message-container">
        <div class="message user-message">{{ message.content }}</div>
        <img src="{{ url_for('static', filename='img/patient.png') }}" alt="You" class="ai-doctor-image">
    </div>
    {% else %}
    <div class="message-container ai-message-container">
        <img src="{{ url_for('static', filename='img/ai-doctor.png') }}" alt="AI Doctor" class="ai-doctor-image">
        <div class="ai-message">{{ message.content }}</div>
    </div>
    {% endif %}
    {% endfor %}
</div>





<div id="percentage-container" class="percentage-container">
    {{ health_rating }}
</div>
<a href="{{url_for('update_number')}}" type="button" method="get" class="update-button">Update Number</a>


<script>
    document.addEventListener('DOMContentLoaded', function () {
        document.getElementById('randomizeButton').addEventListener('click', function () {
            // 获取所有数字span元素
            var numberSpans = document.querySelectorAll('.number');
            // 为每个span生成随机数字
            numberSpans.forEach(function (span, index) {
                if (index === 0) { // 温度
                    span.textContent = (Math.random() * (39.0 - 37.5) + 37.5).toFixed(1);
                } else if (index === 1) { // 心率
                    span.textContent = Math.floor(Math.random() * (100 - 60) + 60);
                } else if (index === 2) { // 氧气饱和度
                    span.textContent = Math.floor(Math.random() * (100 - 90) + 90);
                }
            });
        });
    });
</script>

<div class="bottom-right">
    <img src="../static/image/thermometer-svgrepo-com.svg" alt="Icon" style="width: 40px; height: 40px;">
    <span class="number">38.7</span>
    <img src="../static/image/cardiogram-heart-svgrepo-com.svg" alt="Icon" style="width: 40px; height: 40px;">
    <span class="number">85</span>
    <img src="../static/image/oxygen-breath-svgrepo-com.svg" alt="Icon" style="width: 40px; height: 40px;">
    <span class="number">95</span>
    <!-- 添加按钮 -->
    <button id="randomizeButton">Extracting vital signs</button>
</div>





<div class="chat-footer">
    <form action="{{ url_for('conversation_input') }}" method="post" class="message-form">
        <textarea type="text" name="message" class="chat-input" placeholder="Your text here..."></textarea>
        <button type="submit" class="send-button">Send</button>
    </form>
</div>
{% endblock %}